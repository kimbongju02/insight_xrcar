using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.UI;
using static System.Net.Mime.MediaTypeNames;

public class TestCode : MonoBehaviour
{
    [SerializeField]
    UnityEngine.UI.Image image;
    [SerializeField]
    RawImage rawImage;
    [SerializeField]
    Texture2D bmp;
    [SerializeField]
    byte[] test;

    // Start is called before the first frame update
    void Start()
    {
        test = new byte[]
        {
                0x30, 0x32, 0x32, 0x32, 0xE7, 0x30, 0xAA, 0x7F, 0x32, 0x32, 0x32, 0x32, 0xF9, 0x40, 0xBC, 0x7F,
                0x03, 0x03, 0x03, 0x03, 0xF6, 0x30, 0x02, 0x05, 0x03, 0x03, 0x03, 0x03, 0xF4, 0x30, 0x03, 0x06,
                0x32, 0x32, 0x32, 0x32, 0xF7, 0x40, 0xAA, 0x7F, 0x32, 0xF2, 0x02, 0xA8, 0xE7, 0x30, 0xFF, 0xFF,
                0x03, 0x03, 0x03, 0xFF, 0xE6, 0x40, 0x00, 0x0F, 0x00, 0xFF, 0x00, 0xAA, 0xE9, 0x40, 0x9F, 0xFF,
                0x5B, 0x03, 0x03, 0x03, 0xCA, 0x6A, 0x0F, 0x30, 0x03, 0x03, 0x03, 0xFF, 0xCA, 0x68, 0x0F, 0x30,
                0xAA, 0x94, 0x90, 0x40, 0xBA, 0x5B, 0xAF, 0x68, 0x40, 0x00, 0x00, 0xFF, 0xCA, 0x58, 0x0F, 0x20,
                0x00, 0x00, 0x00, 0xFF, 0xE6, 0x40, 0x01, 0x2C, 0x00, 0xFF, 0x00, 0xAA, 0xDB, 0x41, 0xFF, 0xFF,
                0x00, 0x00, 0x00, 0xFF, 0xE8, 0x40, 0x01, 0x1C, 0x00, 0xFF, 0x00, 0xAA, 0xBB, 0x40, 0xFF, 0xFF,
                0x30, 0x32, 0x32, 0x32, 0xE7, 0x30, 0xAA, 0x7F, 0x32, 0x32, 0x32, 0x32, 0xF9, 0x40, 0xBC, 0x7F,
                0x03, 0x03, 0x03, 0x03, 0xF6, 0x30, 0x02, 0x05, 0x03, 0x03, 0x03, 0x03, 0xF4, 0x30, 0x03, 0x06,
                0x32, 0x32, 0x32, 0x32, 0xF7, 0x40, 0xAA, 0x7F, 0x32, 0xF2, 0x02, 0xA8, 0xE7, 0x30, 0xFF, 0xFF,
                0x03, 0x03, 0x03, 0xFF, 0xE6, 0x40, 0x00, 0x0F, 0x00, 0xFF, 0x00, 0xAA, 0xE9, 0x40, 0x9F, 0xFF,
                0x5B, 0x03, 0x03, 0x03, 0xCA, 0x6A, 0x0F, 0x30, 0x03, 0x03, 0x03, 0xFF, 0xCA, 0x68, 0x0F, 0x30,
                0xAA, 0x94, 0x90, 0x40, 0xBA, 0x5B, 0xAF, 0x68, 0x40, 0x00, 0x00, 0xFF, 0xCA, 0x58, 0x0F, 0x20,
                0x00, 0x00, 0x00, 0xFF, 0xE6, 0x40, 0x01, 0x2C, 0x00, 0xFF, 0x00, 0xAA, 0xDB, 0x41, 0xFF, 0xFF,
                0x00, 0x00, 0x00, 0xFF, 0xE8, 0x40, 0x01, 0x1C, 0x00, 0xFF, 0x00, 0xAA, 0xBB, 0x40, 0xFF, 0xFF,

        };

        SetImage(test);
    }

    void SetImage(byte[] imageData)
    {
        try
        {
            bmp = new Texture2D(720, 480);
            bmp.hideFlags = HideFlags.HideAndDontSave;
            bmp.filterMode = FilterMode.Point;
            ImageConversion.LoadImage(bmp, imageData);

            Vector2 pivot = new Vector2(0.5f, 0.5f);
            UnityEngine.Rect tRect = new UnityEngine.Rect(0, 0, bmp.width, bmp.height);
            Sprite newSprite = Sprite.Create(bmp, tRect, pivot);

            image.overrideSprite = newSprite;

            bmp.Apply();
            rawImage.texture = bmp;
        }
        catch {
            Debug.Log("변환 실패");
        }
    }
}
